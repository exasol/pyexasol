Encryption
==========

Similar to other Exasol connectors, PyEXASOL is capable of using TLS cryptographic protocol.

Exasol published a few articles describing the details:

- `Database connection encryption at Exasol <https://exasol.my.site.com/s/article/Database-connection-encryption-at-Exasol/>`_
- `CHANGELOG: TLS for all Exasol drivers <https://exasol.my.site.com/s/article/Changelog-content-6507>`_
- `CHANGELOG: Database accepts only TLS connections <https://exasol.my.site.com/s/article/Changelog-content-16927>`_
- `Generating TLS files yourself to avoid providing a fingerprint <https://exasol.my.site.com/s/article/Generating-TLS-files-yourself-to-avoid-providing-a-fingerprint/>`_

Default
-------
Encryption with certification validation is ENABLED by default starting from PyExasol version ``1.0.0``.

Encryption is ENABLED by default starting from PyEXASOL version ``0.24.0``.

Encryption was DISABLED by default in previous versions.

Certification verification
--------------------------

- Exasol running "on-premises" uses self-signed SSL certificate by default. You may generate a proper SSL certificate and upload it using `instruction <https://docs.exasol.com/administration/on-premise/access_management/tls_certificate.htm>`_.
- Exasol Docker uses self-signed SSL certificate by default. You may generate a proper SSL certificate and submit it for use via the ConfD API. More details are available on:
   - `GitHub for Exasol Docker <https://github.com/exasol/docker-db>`_
   - `ConfD API <https://docs.exasol.com/db/latest/confd/confd.htm>`_
   - `confd_client cert_update <https://docs.exasol.com/db/latest/confd/jobs/cert_update.htm>`_
- Exasol SAAS running in the cloud allows users to authenticate using:
   1. `username & personal access token (PAT) <https://docs.exasol.com/saas/administration/access_mngt/access_token.htm>`_
   2. `using OpenID <https://docs.exasol.com/db/latest/sql/create_user.htm#Authenti4>`_
        - this uses proper certificate generated by public certificate authority. It does not require any extra setup.

To disable strict certification verification, if needed, in development or testing environments, set ``websocket_sslopt`` to ``{"cert_reqs": ssl.CERT_NONE}``. This is not recommended for production environments, due to the associated increased security risks.

Similar to JDBC / ODBC drivers, PyEXASOL supports fingerprint certificate verification. Please check the examples below.

Specific examples
-----------------

1) How to connect with TLS encryption:

   .. code-block:: python

      pyexasol.connect(dsn='myexasol:8563'
                       , user='user'
                       , password='password')


2) How to connect with TLS encryption and fingerprint verification:

   .. code-block:: python

      pyexasol.connect(dsn='myexasol/135a1d2dce102de866f58267521f4232153545a075dc85f8f7596f57e588a181:8563'
                       , user='user'
                       , password='password'
                       )


3) How to connect with TLS encryption and full certificate verification "on-premises" using internal root CA (certificate authority):

   .. code-block:: python

      pyexasol.connect(dsn='myexasol:8563'
                       , user='user'
                       , password='password'
                       , websocket_sslopt={
                          "cert_reqs": ssl.CERT_REQUIRED,
                          "ca_certs": '/path/to/rootCA.crt',
                       })


4) How to connect to Exasol SAAS (TLS encryption is REQUIRED for SAAS):

   .. code-block:: python

      pyexasol.connect(dsn='abc.cloud.exasol.com:8563'
                       , user='user'
                       , refresh_token='token'
                       , encryption=True
                       )
